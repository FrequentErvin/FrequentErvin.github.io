<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ervin Macic</title>
    <link rel="icon" href="/images/mojaglavusina.jpg"> <!-- icon on tab -->
    <link href="/index.css" rel="stylesheet" type="text/css"> <!-- for footer -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="/css/hover.css" rel="stylesheet" media="all"> <!-- effects on hover navbar-->
    <!-- <link href="/style.css" rel="stylesheet" type="text/css"> -->
    <link href="/blog.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="/blogentries/bloby.css" rel="stylesheet"> <!-- for blob -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sora"> <!-- for font -->
    <script>
      MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <!-- <a class="navbar-brand text-white p-2" href="/index.html"><h2>Ervin Macić</h2></a> -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="navbarSupportedContent">
          <ul class="navbar-nav mb-2 mb-lg-0 justify-content-center">
            <li class="nav-item px-3 justify-content-center">
              <a class="nav-link active text-white hvr-underline-reveal" aria-current="page" href="#" id="GoHome"><h4 style="text-shadow: 1.5px 1.5px #7c7e7b ">About</h4></a>
            </li>
            <li class="nav-item px-3">
              <a class="nav-link text-white hvr-underline-reveal" href="#" id="blog"><h4 style="text-shadow: 1.5px 1.5px #50524f ">Blog</h4></a>
            </li>
            <li class="nav-item px-3">
              <a class="nav-link text-white hvr-underline-reveal" href="/contact.html">
                <h4 style="text-shadow: 1.5px 1.5px #7c7e7b ">Contact</h4>
              </a>
            </li>
            <!-- <li class="nav-item px-3">
              <a class="nav-link text-white hvr-underline-reveal" href="/ErvinMacic_CV.pdf" id="cv" target="_blank"><h4 style="text-shadow: 1.5px 1.5px #7c7e7b ">CV</h4></a>
            </li> -->
            <li class="nav-item px-3">
              <a class="nav-link text-white hvr-underline-reveal" id="project" href="#"><h4 style="text-shadow: 1.5px 1.5px #7c7e7b ">Projects</h4></a>
            </li>
          </ul>
          <!-- <form class="d-flex">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-light" type="submit">Search</button>
          </form> -->
        </div>
      </div>
    </nav>
    <div class="spacer layer1"></div> 
  <a href="#" id="scroll" style="display: none;"><span></span></a>
<div class="container col-md-8 px-4 py-5 shadow-lg my-5">
  <div class="row flex-lg-row-reverse  g-3 py-5 justify-content-center ">
       <div class="col-lg-6">
        <img id="meowth" class="vc-image-1 shadow"> 
      </div> 
    <div class="col-lg-6">
      <h1 class="display-5 fw-bold lh-1 mb-2 m-3"  style="text-shadow: 1.5px 1.5px #7e7b7b "><em>Unexpected expected values</em></h1>
      <p class="lead mb-2 m-3">In this blog post I will discuss the diverse applications of expected values through very unique examples. It is imagined to go from the basics and ramp up quickly.</p>
      <p class="lead mb-2 m-3"> Expected values aren't magical and are very intuitive. It's a concept that we all have programmed in our brains but might not know the formal definition. </p>
    </div>
  </div>
</div>
<main class="container col-md-8">
  <div class="row">
    <!-- <div class="col-md-1"></div> -->
    <div class="">
      <h3 class="pb-4 mb-4 fst-italic border-bottom">
        Mathematics - Expected value - Method of Pertrubation
      </h3>
      <article class="blog-post">
        <h2 class="blog-post-title"> Unexpected expected value</h2>
        <p class="blog-post-meta">January 7, 2023</p>
        <p> I'll start with the definition of expected values. The expected value of an event is the sum of all expected values of all possible outcomes of that event. Ok, now what's the expected value of an outcome is simple
        : it's just the value of that particular outcome times its likelihood. Mathematically put: <div style="overflow-x: auto;" class="container my-3">\[  \textnormal{Expected value} (\textnormal{event}) = \sum \limits_{\textnormal{outcome}}^{\textnormal{all possible outcomes}} \ \textnormal{Value(outcome)} \cdot P(\textnormal{event = outcome}) \]</div>
        or with standard notations, $X$ being the name for the event and $x$ being the value of the event.
        <div style="overflow-x: auto;" class="container my-3">\[ \mathbb{E}[X] = \sum \limits_{x}^{} \ x \cdot P(X = x) \]</div>
        Note the differences in capitalization of $x$ represent different things. To make this clear, here's the standard example: 
        </p>
        <div class="px-5 pt-2 my-2 text-center">
          <img src="https://pngimg.com/uploads/dice/dice_PNG49.png" class="img-fluid">
        <h1 class="display-4 fw-bold"></h1>
        <div class="col-lg-6 mx-auto">
          <p class="lead mb-4"> Imagine you throw a six-sided dice $100$ times and add up all the numbers you got. What approximate number do you expect i.e. what's the expected value of this event? </p>
        </div>
        </div>
        Going by the above definition the problem would be partitioned into $6$ events: you roll a $1$, you roll a $2$ ... you roll a $6$. Calculating the expected value of one dice roll you get: $1/6 \cdot 1 + 1/6 \cdot 2 + ... + 1/6 \cdot 6 = 3.5$.
        It is obvious that the expected values "stack" (you can verify by calculating the $100$ at once) so we can conclude that the expected value of our $100$ rolls is $350$.
        <hr>
        
        <p>When I was little, I loved to play the Pokémon Trading Card Game. Thought, I hated these types of moves: </p>
        <div class="px-5 pt-2 my-2 text-center">
          <img src="https://cdn.shopify.com/s/files/1/0128/0782/products/xy3-21_grande.jpg?v=1495819968" style="height: 400px;">
        <div class="col-lg-6 mx-auto p-3">
          <p class="lead mb-4"> "Flip $3$ coins. This attack does $10$ damage times the number of heads." </p>
        </div>
        </div>
        <div class="px-5 pt-2 my-2 text-center">
          <img src="https://i.pinimg.com/originals/0d/8d/52/0d8d52114c6ee2098a52ff84b57697c8.jpg" style="height: 380px;">
        <h1 class="display-4 fw-bold"></h1>
        <div class="col-lg-6 mx-auto">
          <p class="lead mb-4"> "Flip a coin until you get tails. This attack does $30$ damage times the number of heads." </p>
        </div>
        </div>
        <p> I didn't know should I save up more energy for the second attack or do the first attack for less energy. 
          I didn't have an idea what's the average damage the first move would do. After I learned enough math and taught myself
          expected values, I decided to figure it out.
        </p>
        <p>
          I found the average in two ways. First one using pretty standard calculations with probability and the second
          one I used the so called Linearity of Expectations. I'll first work on the Cubchoo.
        </p>
        <h3>Cubchoo's move - Fury Swipes</h3> <hr>
        <h3> Solution 1: </h3>
        
        <p>
          Let $T$ be tails, and $H$ be heads. $HTT$ means we got one heads in three throws and it was in the first
          throw. <br> There's a total of $8$ different possible outcomes of these $3$ coin flips:
          <br>
          \[ TTT, TTH, THT, THH, HTT, HTH, HHT, HHH \]
          <p>
            (binary strings of length $3$ if you think of the $H$ as a $1$).
          </p>
         
          <br>
          The outcome $TTT$ has value $0$ and its probability of happening is $1/8$. since  $$ <br> 
          The outcome $HHH$ has value $10 \times 3$ and probability $1/8$. <br> 
          The outcomes $HTT, THT, TTH$ have value $30$ and probability $3/8$ that any of them happens. <br> The outcomes $HHT, HTH, THH$ have value $20$ and probability $3/8$ that any of them happens. <br><br> We've covered all cases and can calculate the expected value now: $\mathbb{E}[\textnormal{Fury Swipes}] = \frac{1}{8} \cdot
          0 + \frac{1}{8} \cdot 30 + \frac{3}{8} \cdot 20 + \frac{3}{8} \cdot 10 = 15$. <br><br> It turns out that it's no accident that this is $3
          \cdot 10 /2$. Generalizing the move to $n$ throws, each dealing $d$ damage we get: $\frac{d\cdot n}{2}$. Here's the proof:
          <br> <br>
          We need to calculate the probability of having exactly $k$ heads $(k \in (0,n) )$. This is the same as calculating the number of binary
          strings of length $n$ with exactly $k$ ones. This is just the number of ways to choose $k$ places to place the ones, so this is ${n \choose k}$. 
          So this contributes to our expected value with $\frac{n \choose k}{2^n} \cdot d \cdot k$. <br>
          We need to calculate the sum <div style="overflow-x: auto;" class="container my-3"> \[ \sum \limits_{k=0}^{n} {d \cdot k} \cdot \frac{n \choose k}{2^n} = d \cdot \sum \limits_{k=0}^{n} k \cdot \frac{n \choose k}{2^n} = 
          d \cdot \sum \limits_{k=0}^{n} n \cdot \frac{n - 1 \choose k - 1}{2^n} = \frac{dn}{2} \] </div>
          I used the following facts: \[ (1+1)^n = \sum \limits_{k=0}^{n} {n \choose k} = 2^n \] 
          \[ k \cdot {n \choose k} = n \cdot {n-1 \choose k-1} \]
        </p>
        <hr>
        <h3> Solution 2: </h3>
        
        <p>
          A much faster solution is to use <b>Linearity of Expectations</b>. Linearity says that $\mathbb{E}[A+B] = \mathbb{E}[A] + \mathbb{E}[B]$ for $A,B$ independent
          or dependent events. For example, if we have two dice rolls the expected value of this event as a whole is the same as the expected
          value of the first dice roll plus the second roll. <br> This logic allows us to destroy the above problem. Each coin flip is an event
          of its own and has its own expected value. The expected value of one coin flip is obviously $d/2$ so since we have $n$ flips 
          the expected value will be $dn/2$ and we're done. 
          <br> This might not be too impressive, but the second link in further reading will show the true power of <b>LoE</b> (Linearity of 
          Expectations) on the problem <i>What's the expected number of cycles in a random permutation?</i>. <br> <br> <b>Spoiler:</b> turns out for $n$ elements it's the harmonic sum up until $n$ terms.
        </p>
        <hr>
        <h3>Pikachu's move - Iron Tail</h3>
        <p>
          As a fun exercise, try to determine the expected value of Pikachu's move that deals an additional $30$ damage for each flip until you get a tails. 
          The answer is somewhat surprisingly just $30$. In general for $d$ damage per heads the answer is $d$.<br><br>
          Here's a nice diagram that depicts the possibility space of the flips:
        </p>
        <hr>
        <div class="px-5 pt-2 my-2 text-center">
          <img src="/images/blog/pikachutree.jpg" style=" width: 100%; height: auto; max-width: 600px;">
        <h1 class="display-4 fw-bold"></h1>
        <div class="col-lg-6 mx-auto">
          <p class="lead mb-4"> Each level down you go, you add $1/2$ to probability of it happening. </p>
        </div>
        </div>
        <p>
          Now let's calculate the expected value: <br>
          Following the tree downwards keeping track of the red letters where we stop we get the following: <br>
         \[ \mathbb{E}[\textnormal{Iron Tail}] = \frac{1}{2} \cdot 0 + \frac{1}{2^2}\cdot d + \frac{1}{2^3}\cdot 2d + \frac{1}{2^4}\cdot 3d + \ldots \]<br>
          \[ \mathbb{E}[\textnormal{Iron Tail}] = \frac{d}{2} \cdot (\frac{1}{2}+\frac{2}{2^2}+\frac{3}{2^3}+\ldots) \]
          We find the following sum:
          \[ \sum \limits_{k=1}^{\infty} \frac{k}{2^k} = 2 \]
          hence we get:
          \[ \mathbb{E}[\textnormal{Iron Tail}] = \frac{d}{2} \cdot 2 = d \ \ \blacksquare. \]
          You can find the above sum in a plethora of ways (See most of them <a target="_blank" href="https://math.stackexchange.com/questions/337937/why-sum-k-1-infty-frack2k-2">here</a>). My favorite go-to method is the <b>Method of Pertrubation</b>:
          <br>
          <br>
          Denote the sum up until $k$ terms as $s_k$. I'll find the closed form of $s_k$. <br>
          \[ s_{k+1} = s_{k} + \frac{k+1}{2^{k+1}} = \frac{1}{2}+(\frac{2}{2^2}+\frac{3}{2^3}+\ldots + \frac{k+1}{2^{k+1}}) \] 
          \[ = \frac{1}{2} + (\frac{1}{2^2} + \ldots \frac{1}{2^{k+1}}) + \frac{1}{2}(\frac{1}{2} + \frac{2}{2^2} + \ldots + \frac{k}{2^k}) \]
          \[ = \frac{1}{2} + \frac{1}{4} \cdot (1-\frac{1}{2^k}) \cdot 2 + \frac{1}{2} \cdot s_k\]
          \[ \implies s_k = 2 - \frac{k+2}{2^k} \]
          I left out the comparing of the first equation with the last. It's straightforward. <br>
          Hence its limit is $2$ as $k$ goes to infinity since $k+2$ is eaten up by the $2^k$. <br>
          The idea is to first separate the first term and the last and then compare the two expressions. The goal is to
          manipulate the both sides to reach previous terms, analogous to recursion. It works on a lot of different sums and 
          is very useful to keep in mind.
        </p>

        <h4 class="text-primary">Links for further reading</h4>
        <ul>
          <li><a target="_blank" href="https://web.evanchen.cc/handouts/ProbabilisticMethod/ProbabilisticMethod.pdf">Evan Chen's Probabilistic method</a></li>
          <li><a target="_blank" href="https://www.cantorsparadise.com/how-many-cycles-will-you-find-in-a-random-permutation-c88288bcdb5">"How Many Cycles Will You Find in a Random Permutation?" by Haris Angelidakis</a></li>
        </ul>
        
      </article>
    </div>
    <!-- <div class="col-md-1"></div> -->
  </div>

</main>
    <script src="/blog.js"></script>
    <script src="/index.js"></script>
    <div class="spacer whiteblack"></div>

    <footer class="site-footer">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 col-md-6">
            <h6>About</h6>
            <p class="text-justify">For any questions, comments or you just want to chat, visit the <a>Contact</a> page. I love sharing
              ideas and talking with smart people, so by all means, please do! Besides that, check in weekly to see the weekly blog post or fact.  </p>
          </div>
  
        </div>
        <hr>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8 col-sm-6 col-xs-12">
            <p class="copyright-text">Copyright &copy; 2023 All Rights Reserved by 
         <a href="https://github.com/FrequentErvin">Ervin Macić</a>.
            </p>
          </div>
  
          <div class="col-md-4 col-sm-6 col-xs-12">
            <ul class="social-icons">
              <li><a class="facebook" href="https://www.facebook.com/ervin.macic/"><i class="fa fa-facebook"></i></a></li>
              <li><a class="twitter" href="https://twitter.com/Ervin83228183"><i class="fa fa-twitter"></i></a></li>
              <li><a class="dribbble" href="https://www.instagram.com/ervin.macic/" ><i class="fa fa-instagram"></i></a></li>
              <li><a class="linkedin" href="https://www.linkedin.com/in/ervin-macic-2a300a1ab/"><i class="fa fa-linkedin"></i></a></li>   
            </ul>
          </div>
        </div>
      </div>
  </footer>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
  </body>
</html>  